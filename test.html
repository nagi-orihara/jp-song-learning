<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>聽歌學日文</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">
    <div class="max-w-md mx-auto bg-white shadow-xl rounded-lg p-6">
        <h1 class="text-xl font-bold mb-4 text-center">聽歌學日文測試版</h1>
        
        <div class="space-y-4">
            <input type="date" id="date" class="w-full border p-2 rounded">
            <input type="text" id="yt" class="w-full border p-2 rounded" placeholder="貼上 YouTube ID (例如 dQw4w9WgXcQ)">
            <textarea id="txt" class="w-full border p-2 h-32 rounded" placeholder="輸入任何內容測試"></textarea>
            
            <button onclick="save()" class="w-full bg-blue-500 text-white p-3 rounded font-bold">按我儲存</button>
            <button onclick="clearData()" class="w-full bg-red-100 text-red-600 p-2 rounded text-xs">清除所有資料</button>
        </div>

        <hr class="my-6">

        <div id="display" class="bg-yellow-50 p-4 rounded min-h-[100px] whitespace-pre-wrap text-gray-700">
            這裡會顯示儲存的內容
        </div>
        <div id="video" class="mt-4 aspect-video bg-black rounded"></div>
    </div>

    <script>
        // 這是最基本的儲存函數
        function save() {
            const d = document.getElementById('date').value;
            const y = document.getElementById('yt').value;
            const t = document.getElementById('txt').value;
            
            if(!d) {
                alert("請選日期！");
                return;
            }

            const data = { youtube: y, content: t };
            localStorage.setItem('lesson-' + d, JSON.stringify(data));
            
            alert("儲存成功！日期是：" + d);
            show();
        }

        function show() {
            const d = document.getElementById('date').value;
            const raw = localStorage.getItem('lesson-' + d);
            const box = document.getElementById('display');
            const vBox = document.getElementById('video');

            if(raw) {
                const obj = JSON.parse(raw);
                box.innerText = obj.content;
                if(obj.youtube) {
                    vBox.innerHTML = <iframe class="w-full h-full" src="https://www.youtube.com/embed/${obj.youtube}" frameborder="0" allowfullscreen></iframe>;
                }
            } else {
                box.innerText = "這天沒有資料";
                vBox.innerHTML = "";
            }
        }

        function clearData() {
            if(confirm("確定刪除？")) {
                localStorage.clear();
                location.reload();
            }
        }

        // 當日期改變時，自動讀取
        document.getElementById('date').onchange = show;
    </script>
</body>
</html>